<ngx-ui-loader [loaderId]="'obj'"></ngx-ui-loader>
<div class="row">

    <div class="col-md-12">
        <nb-card>
            <nb-card-header>
                An√°lisis de resultados
            </nb-card-header>
            <nb-card-body>
                <nb-tabset>
                    <nb-tab tabTitle="Global">
                        <div class="row">
                            <div class="col-md-2">
                                <mat-form-field class="full-width">
                                    <mat-label>Filtrar por curso</mat-label>
                                    <mat-select (selectionChange)="onSelectedGeneralGrade($event)">
                                        <mat-option *ngFor="let grade of grades" [value]="grade.id">
                                            {{grade.description }}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="col-md-2">
                                <mat-form-field class="full-width">
                                    <mat-label>Filtrar por Asignatura</mat-label>
                                    <mat-select (selectionChange)="onSelectedGeneralSubject($event)">
                                        <mat-option *ngFor="let subject of subjects" [value]="subject.id">
                                            {{subject.description }}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                        </div>
                        <ngx-charts-bar-vertical-normalized [view]="view" [scheme]="colorScheme" [results]="multi3"
                            [gradient]="gradient" [xAxis]="showXAxis" [yAxis]="showYAxis" [legend]="showLegend"
                            [showXAxisLabel]="showXAxisLabel" [showYAxisLabel]="showYAxisLabel"
                            [xAxisLabel]="xAxisLabel" [yAxisLabel]="yAxisLabel">
                        </ngx-charts-bar-vertical-normalized>
                    </nb-tab>
                    <nb-tab tabTitle="Detalle">
                        <div class="row">
                            <div class="col-md-2">
                                <mat-form-field class="full-width">
                                    <mat-label>Filtrar por curso</mat-label>
                                    <mat-select (selectionChange)="onSelectedGrade($event)">
                                        <mat-option *ngFor="let grade of grades" [value]="grade.id">
                                            {{grade.description }}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="col-md-2">
                                <mat-form-field class="full-width">
                                    <mat-label>Filtrar por Asignatura</mat-label>
                                    <mat-select (selectionChange)="onSelectedSubject($event)">
                                        <mat-option *ngFor="let subject of subjects" [value]="subject.id">
                                            {{subject.description }}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-2">
                                <mat-form-field class="full-width">
                                    <mat-label>Seleccione Objetivo</mat-label>
                                    <mat-select (selectionChange)="onSelectedObjective($event)">
                                        <mat-option *ngFor="let objective of filteredLearningObjectives"
                                            [value]="objective.id">
                                            {{objective.description }}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                        </div>
                        <div *ngIf="objectiveData.length">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Objetivo</th>
                                        <th>Indicador</th>
                                        <th>cantidad de notas</th>
                                    </tr>

                                </thead>
                                <tbody>
                                    <ng-container *ngFor="let objective of objectiveData">
                                        <tr>
                                            <td>{{objective.objectiveId}}</td>
                                            <td>{{objective.id}}</td>
                                            <td>
                                                {{objective.califications.length}}
                                            </td>
                                        </tr>
                                    </ng-container>
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <th colspan="2">NL</th>
                                        <td style="text-align:center">{{low.length}}</td>
                                    </tr>
                                    <tr>
                                        <th colspan="2">ML</th>
                                        <td style="text-align:center">{{medium.length}}</td>
                                    </tr>
                                    <tr>
                                        <th colspan="2">L</th>
                                        <td style="text-align:center">{{high.length}}</td>
                                    </tr>
                                </tfoot>
                            </table>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="col-md-6">
                                        <h6>Indicadores</h6>
                                        <ngx-charts-bar-vertical-normalized [view]="view2" [scheme]="colorScheme"
                                            [results]="multi2" [gradient]="gradient" [xAxis]="showXAxis"
                                            [yAxis]="showYAxis" [legend]="showLegend" [showXAxisLabel]="showXAxisLabel"
                                            [showYAxisLabel]="showYAxisLabel" [xAxisLabel]="xAxisLabel"
                                            [yAxisLabel]="yAxisLabel">
                                        </ngx-charts-bar-vertical-normalized>
                                    </div>
                                    <h6>Objetivo</h6>
                                    <ngx-charts-bar-vertical-normalized [view]="view" [scheme]="colorScheme"
                                        [results]="multi" [gradient]="gradient" [xAxis]="showXAxis" [yAxis]="showYAxis"
                                        [legend]="showLegend" [showXAxisLabel]="showXAxisLabel"
                                        [showYAxisLabel]="showYAxisLabel" [xAxisLabel]="xAxisLabel"
                                        [yAxisLabel]="yAxisLabel">
                                    </ngx-charts-bar-vertical-normalized>
                                </div>
                            </div>
                        </div>
                    </nb-tab>

                </nb-tabset>
            </nb-card-body>
        </nb-card>
    </div>
</div>